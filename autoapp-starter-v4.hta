<html>

<head>

<title>auto-app-starter v4</title>

<HTA:APPLICATION
  APPLICATIONNAME="Auto-appstarter-v4"
  VERSION="4"
  CONTEXTMENU="yes"/>    

<script language=JScript>

    window.onload = function () {
        var height = screen.availHeight - 100;
        self.resizeTo(640, height);
        self.moveTo(100, 50);
    }

    var WshShell = new ActiveXObject("WScript.Shell");
    var sIEPath = "\"C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe\"";
    var sSteamPath = "\"P:\\Program Files (x86)\\Steam\\Steam.exe\"";
    var sExplorerPath = "\"c:\\Windows\\explorer.exe\""
    var sPutyPortable = "\"S:\\My Dropbox\\PuTTYPortable\\PuTTYPortable.exe\""

    var arAppPaths = [0, sExplorerPath, sIEPath, sSteamPath, sPutyPortable];
    var arAppTimes = [0,      3,           4,         5,             6    ];

    function fnRunExe(arAppPaths, iNumSec, iCounter) {
        var fnRunIt = function () {
            if (iTime < arAppPaths.length) {
            oTimer.innerHTML += "</br>Just ran: </br>" + arAppPaths[iCounter] + " with number of seconds " + iNumSec 
			+ "</br> also, counter is " + iCounter;
                    WshShell.run(arAppPaths[iCounter]);
            } 
        }

	var iTime = setTimeout(fnRunIt, iNumSec );
}
/* *************************************************************** */
	function iConvertSeconds(i) {
		if (i < 60) {
			return i * 1000;
		}
	}
/* *************************************************************** */

	function fnForTheCalling() {
	    for (var i = 1; i < arAppTimes.length; i++) {
	        var iKeepTrack = 0;
	        for (var j = 1, iSumTotal = 0; j <= i; j++) {
	            iSumTotal += arAppTimes[j];
	        }
	        iKeepTrack = iConvertSeconds(iSumTotal);


	        fnRunExe(arAppPaths, iKeepTrack, i);
	    }
	}
/* *************************************************************** */
//		found below on http://stackoverflow.com/questions/1230233/how-to-go-through-an-array-and-add-their-values
//		for (var k = 0, iSumTotal = 0; k < arAppPaths.length; iSumTotal += arAppTimes[k++] );
</script>
</head>
    <div class="body">
	<h1>setInterval Method Sample</h1>

	<span id="oTimer" style="font-size: 16pt; font-weight: bold; font-family: Times; color: #0000FF;">
	Interval Stopped</span>
	<p><input type="button" value="Start Interval" onclick="fnStartInterval()">
	<input type="button" value="Run Exe" onclick="fnForTheCalling()">
	<!-- START_PAGE_FOOTER --><br>
	<br>
	<br>
	</p>
    </div>
</html>

